<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2026 Alignment Audit</title>
  <style>
    :root {
      --color-primary: #0f172a;
      --color-success: #22C55E;
      --color-warning: #F59E0B;
      --color-error: #EF4444;
      --color-bg: #F8FAFC;
      --color-surface: #FFFFFF;
      --color-text: #0f172a;
      --color-muted: #475569;
      --color-border: rgba(15, 23, 42, 0.10);
      --radius-card: 18px;
      --radius-item: 14px;
      --shadow-card: 0 2px 14px rgba(15, 23, 42, 0.06);
      --shadow-hover: 0 10px 28px rgba(15, 23, 42, 0.10);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.65;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .container { max-width: 920px; margin: 0 auto; padding: 64px 20px; }
    .header { text-align: center; margin-bottom: 28px; }
    .header h1 {
      font-size: 2.2rem;
      letter-spacing: -0.04em;
      margin-bottom: 10px;
      color: var(--color-text);
    }
    .header p {
      font-size: 1.1rem;
      color: var(--color-muted);
      margin-bottom: 6px;
    }
    .progress-bar {
      width: 0%;
      height: 6px;
      background: rgba(15, 23, 42, 0.08);
      border-radius: 999px;
      margin-top: 18px;
      overflow: hidden;
    }
    .progress-fill {
      height: 0%;
      background: var(--color-primary);
      border-radius: 999px;
      transition: width 0.3s ease;
      width: 0%;
    }
    .section, .chapter-card {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-card);
      box-shadow: var(--shadow-card);
    }
    .section { padding: 32px; margin-bottom: 24px; }
    .section h2 {
      font-size: 1.15rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      margin-bottom: 12px;
      color: var(--color-text);
    }
    .question-label {
      font-weight: 800;
      margin-bottom: 12px;
      color: var(--color-text);
      font-size: 1rem;
    }
    .options { display: flex; flex-direction: column; gap: 12px; }
    .option, .result-card, .action-item {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      cursor: pointer;
      padding: 20px 22px;
      border-radius: var(--radius-item);
      background: #fff;
      border: 1px solid var(--color-border);
      transition: box-shadow 0.15s ease, transform 0.05s ease, border-color 0.15s ease, background 0.15s ease;
    }
    .option:hover { box-shadow: var(--shadow-hover); }
    #resultsSection .result-card, #resultsSection .action-item {
      cursor: default;
      transform: none !important;
    }
    #resultsSection .result-card:hover, #resultsSection .action-item:hover {
      box-shadow: none !important;
    }
    .option:active { transform: translateY(1px); }
    .option.is-selected {
      border-color: rgba(15, 23, 42, 0.22);
      background: rgba(15, 23, 42, 0.02);
      box-shadow: var(--shadow-hover);
    }
    .option input[type="radio"] {
      margin-top: 3px;
      cursor: pointer;
      accent-color: var(--color-primary);
      flex-shrink: 0;
    }
    .option label { cursor: pointer; flex: 1; }
    .option label p { margin: 0; }
    .label-title { font-weight: 800; color: var(--color-text); margin-bottom: 4px; }
    .label-desc { font-size: 0.95rem; color: var(--color-muted); }
    .button-group { display: flex; gap: 12px; margin-top: 26px; justify-content: center; flex-wrap: wrap; }
    .btn {
      padding: 12px 22px;
      border: 1px solid transparent;
      border-radius: 999px;
      font-size: 1rem;
      font-weight: 800;
      cursor: pointer;
      transition: transform 0.05s ease, box-shadow 0.15s ease, opacity 0.15s ease;
    }
    .btn:active { transform: translateY(1px); }
    .btn-primary {
      background: var(--color-primary);
      color: #fff;
      box-shadow: var(--shadow-card);
    }
    .btn-secondary {
      background: rgba(15, 23, 42, 0.03);
      color: var(--color-text);
      border-color: var(--color-border);
    }
    .btn:disabled { opacity: 0.55; cursor: not-allowed; }
    .hidden { display: none !important; }
    #previewButtons {
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--color-bg);
      padding: 12px 0;
      border-bottom: 2px solid var(--color-border);
      margin-bottom: 20px;
    }
    #previewButtons .button-group { margin: 0; }
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(2, 6, 23, 0.72);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }
    .modal-content {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-card);
      padding: 34px;
      max-width: 520px;
      width: 100%;
      box-shadow: 0 18px 60px rgba(2, 6, 23, 0.35);
    }
    .modal-content h2 {
      font-size: 1.4rem;
      letter-spacing: -0.03em;
      margin-bottom: 10px;
      color: var(--color-text);
    }
    .modal-content p { color: var(--color-muted); margin-bottom: 18px; }
    .form-group { margin-bottom: 16px; text-align: left; }
    .form-group label { display: block; margin-bottom: 8px; font-weight: 700; color: var(--color-text); }
    .form-group input {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid var(--color-border);
      border-radius: 12px;
      font-size: 1rem;
    }
    .form-group input:focus {
      outline: none;
      border-color: rgba(15, 23, 42, 0.25);
      box-shadow: 0 0 0 4px rgba(15, 23, 42, 0.06);
    }
    .results {
      padding: 0;
      background: transparent;
      border: none;
      box-shadow: none;
    }
    .result-header { text-align: center; margin-bottom: 24px; }
    .score-number {
      font-size: 3.8rem;
      font-weight: 700;
      letter-spacing: -0.045em;
      margin: 0 auto 6px;
      line-height: 1.0;
    }
    .score-number.strong { color: var(--color-success); }
    .score-number.medium { color: var(--color-warning); }
    .score-number.weak { color: var(--color-error); }
    .result-title {
      font-size: 1.5rem;
      letter-spacing: -0.03em;
      margin-bottom: 6px;
      color: var(--color-text);
    }
    .result-subtitle { font-size: 1rem; color: var(--color-muted); margin-top: 2px; }
    .preview-score {
      font-size: 3rem;
      font-weight: 700;
      letter-spacing: -0.045em;
      margin: 14px 0 18px;
      color: var(--color-primary);
      line-height: 1.0;
    }
    .chapter-card { padding: 34px; margin: 24px 0; }
    .section-title {
      font-size: 1.15rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      margin: 0 0 16px;
      color: var(--color-text);
    }
    #resultsSection .result-card, #resultsSection .action-item {
      transition: none;
      display: block;
    }
    #resultsSection .result-card:hover, #resultsSection .action-item:hover {
      box-shadow: none;
      transform: none;
    }
    .result-card {
      cursor: default;
      margin-bottom: 12px;
      display: block;
    }
    .result-card h3 {
      margin-bottom: 6px;
      font-size: 1.0rem;
      letter-spacing: -0.01em;
    }
    .result-card p { margin: 0; }
    .trend-stat {
      margin-top: 10px;
      padding: 0;
      border: none;
      background: transparent;
      font-size: 0.95rem;
      color: var(--color-muted);
    }
    .action-items { margin-top: 0; padding-top: 0; border-top: none; }
    .action-item {
      cursor: default;
      flex-direction: column;
      gap: 8px;
    }
    .action-content h4 {
      font-size: 1.05rem;
      letter-spacing: -0.015em;
      margin-bottom: 2px;
      color: var(--color-text);
    }
    .action-content p {
      margin: 0;
      color: var(--color-muted);
    }
    .priority-badge {
      display: inline-flex;
      align-items: center;
      margin-bottom: 16px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 800;
      letter-spacing: 0.01em;
      border: 1px solid rgba(15, 23, 42, 0.14);
      background: rgba(15, 23, 42, 0.03);
      color: var(--color-text);
      width: fit-content;
    }
    .priority-high {
      border-color: rgba(239, 68, 68, 0.35);
      background: rgba(239, 68, 68, 0.08);
    }
    .priority-medium {
      border-color: rgba(245, 158, 11, 0.35);
      background: rgba(245, 158, 11, 0.10);
    }
    .priority-low {
      border-color: rgba(34, 197, 94, 0.35);
      background: rgba(34, 197, 94, 0.08);
    }
    .unified-gap-card {
      background: white;
      padding: 24px;
      margin-bottom: 16px;
      border-radius: var(--radius-item);
      border: 1px solid var(--color-border);
    }
    .gap-section {
      margin-bottom: 20px;
    }
    .actions-section {
      padding: 16px;
      margin-top: 16px;
      background: rgba(15, 23, 42, 0.03);
      border-radius: 8px;
      border: 1px solid rgba(15, 23, 42, 0.08);
    }
    .actions-label {
      font-weight: 700;
      font-size: 0.9rem;
      color: var(--color-text);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .action-bullet {
      margin-bottom: 10px;
      font-size: 0.95rem;
      color: var(--color-muted);
      line-height: 1.6;
    }
    .action-bullet strong {
      color: var(--color-text);
    }
    .booking-section {
      margin-top: 40px;
      padding-top: 32px;
      border-top: 2px solid var(--color-border);
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      flex-wrap: nowrap;
    }
    .booking-text {
      font-size: 1rem;
      color: var(--color-muted);
      margin: 0;
      white-space: nowrap;
    }
    .booking-link {
      display: inline;
      font-size: 1.05rem;
      font-weight: 700;
      color: var(--color-primary);
      text-decoration: none;
      padding-left: 8px;
      transition: color 0.15s ease;
    }
    .booking-link:hover {
      background: rgba(15, 23, 42, 0.05);
      transform: translateY(-1px);
    }
    .download-section {
      margin-top: 32px;
      text-align: center;
    }
    .download-section + div {
      margin-top: 24px;
    }
    .chapter-card {
      margin-bottom: 24px;
      margin-top: 0;
    }
    .btn:hover:not(:disabled) {
      box-shadow: var(--shadow-hover);
      transform: translateY(-1px);
    }
    .btn:hover:not(:disabled).btn-primary {
      background: #1e293b;
    }
    .retake-section {
      text-align: center;
    }
    @media (max-width: 768px) {
      .container { padding: 28px 16px; }
      .section { padding: 22px; }
      .results { padding: 22px; }
      .chapter-card { padding: 22px; }
    }
  </style>
</head>
<body>
  <div id="previewButtons" class="hidden">
    <div class="button-group">
      <button class="btn btn-secondary" onclick="previewLow()">Low Score Preview</button>
      <button class="btn btn-secondary" onclick="previewMid()">Mid Score Preview</button>
      <button class="btn btn-secondary" onclick="previewHigh()">High Score Preview</button>
      <button class="btn btn-primary" onclick="backToQuiz()">Back to Quiz</button>
    </div>
  </div>

  <div class="container">
    <div id="auditSection">
      <div class="header">
        <h1 id="mainHeadline">How Does Your Strategy Stack Up?</h1>
        <p id="mainSubheadline">You versus what's working in 2026</p>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <form id="auditForm"></form>
      <div class="button-group">
        <button type="submit" class="btn btn-primary" onclick="document.getElementById('auditForm').dispatchEvent(new Event('submit'))">Get My Results</button>
      </div>
    </div>

    <div id="emailGate" class="modal-overlay hidden">
      <div class="modal-content">
        <h2 id="emailGateTitle">Get Your Alignment Score</h2>
        <p id="emailGateSubtitle">Enter your email to receive your personalized breakdown</p>
        <div class="preview-score" id="previewScore">0%</div>
        <form id="emailForm">
          <div class="form-group">
            <label for="userEmail">Email</label>
            <input type="email" id="userEmail" name="email" required placeholder="you@company.com" />
          </div>
          <button type="submit" class="btn btn-primary" id="submitEmail">Get My Results</button>
        </form>
      </div>
    </div>

    <div id="resultsSection" class="hidden">
      <div class="results">
        <div class="header">
          <h1 id="resultsHeadline">How Does Your Strategy Stack Up?</h1>
          <p id="resultsSubheadline">You versus what's working in 2026</p>
        </div>
        <div class="result-header">
          <div class="score-number" id="scoreNumber">0%</div>
          <h2 class="result-title" id="resultTitle">Your Score</h2>
          <p class="result-subtitle" id="resultSubtitle">Results</p>
        </div>
        <div id="resultsContent"></div>
        <div class="download-section">
          <button class="btn btn-primary" onclick="downloadPDF()">Download Results</button>
        </div>
        <div class="booking-section">
          <p class="booking-text">Want help closing these gaps? <a class="booking-link" target="_blank" id="bookingLink">â†’ Book a Strategy Call</a></p>
        </div>
        <div class="retake-section">
          <button class="btn btn-secondary" onclick="resetAudit()">Retake Assessment</button>
        </div>
      </div>
    </div>
  </div>

  <script>
// ============================================
// ðŸ“ EDIT ALL CONTENT HERE - NOTHING ELSE!
// ============================================

const CONTENT = {
  // Main Headlines
  headline: "How Does Your Strategy Stack Up Against 2026 Market Reality?",
  subheadline: "Take this 8-question audit to see where you stand and what to fix first.",
  
  // Email Gate
  emailGateTitle: "Get Your Personalized Results",
  emailGateSubtitle: "Enter your email to see your score and action plan",
  
  // ConvertKit Integration
  convertKitFormId: '8975679',
  convertKitApiKey: 'kit_6d1448764627b0fa1dfa960f512981c4',
  
  // Booking Link (shown at bottom of results)
  bookingText: "Want help closing these gaps?",
  bookingLinkText: "â†’ Book a Strategy Call",
  bookingLinkUrl: "https://calendly.com/your-link",
  
  // Questions
  questions: [
    {
      id: 'q1',
      category: 'Email Strategy',
      question: '1. How do you currently measure email performance?',
      options: [
        { 
          value: 'none', 
          points: 0,
          title: 'Currently not measuring', 
          desc: 'Not tracking performance metrics, triggers, or events'
        },
        { 
          value: 'opens', 
          points: 0.25,
          title: 'Open rates (primary metric)', 
          desc: 'This is our main KPI'
        },
        { 
          value: 'clicks', 
          points: 0.25,
          title: 'Clicks & conversions', 
          desc: 'Shifted away from opens as primary'
        },
        { 
          value: 'revenue', 
          points: 1,
          title: 'Revenue & lifetime value (LTV) per send', 
          desc: 'Tracking full-funnel impact',
          strength: { title: 'Email Metrics', desc: 'You are measuring revenue impact not vanity metrics.' },
          gapIfNotChosen: {
            title: 'Email Metrics Gap',
            desc: 'Open rates became less reliable after privacy changes. Strong teams prioritize clicks conversions and revenue per send.',
            trend: 'Deliverability is increasingly tied to engagement quality not vanity metrics.'
          }
        }
      ]
    },
    {
      id: 'q2',
      category: 'Email Personalization',
      question: '2. How personalized is your email program?',
      options: [
        { 
          value: 'generic', 
          points: 0,
          title: 'Generic sends (minimal segmentation)', 
          desc: 'Same email to most subscribers'
        },
        { 
          value: 'segment', 
          points: 0.5,
          title: 'Basic segmentation (3â€“5 groups)', 
          desc: 'Segment by role company size or past purchase'
        },
        { 
          value: 'behavioral', 
          points: 1,
          title: 'Behavioral personalization + automated sequences', 
          desc: 'Recency engagement depth LTV dynamic content and automated journeys',
          strength: { title: 'Behavioral Personalization', desc: 'Behavioral personalization plus automated sequences puts you near the top tier.' },
          gapIfNotChosen: {
            title: 'Personalization Gap',
            desc: 'Basic segmentation helps but behavior-based personalization + automated sequences is the new baseline for relevance.',
            trend: 'Expectations have shifted toward lifecycle automation and engagement-based segmentation.'
          }
        }
      ]
    },
    {
      id: 'q3',
      category: 'Website Intent Capture',
      question: '3. When someone hits your site (paid or organic) do you capture intent and follow up if they don\'t book?',
      options: [
        { 
          value: 'none', 
          points: 0,
          title: 'Currently have no tracking system', 
          desc: 'May or may not have an email opt-in, but not using it'
        },
        { 
          value: 'leak', 
          points: 0.25,
          title: 'We mostly lose them', 
          desc: 'We get traffic but have limited tracking/capture and no consistent follow-up'
        },
        { 
          value: 'capture', 
          points: 0.5,
          title: 'We capture some intent + do manual follow-up', 
          desc: 'Basic tracking + forms; follow-up happens but it\'s inconsistent'
        },
        { 
          value: 'capture-auto', 
          points: 1,
          title: 'We capture intent + run automated follow-up sequences', 
          desc: 'Behavior events (pricing case study demo page) trigger email/retargeting follow-ups for non-bookers',
          strength: { title: 'Intent Capture + Follow-Up', desc: 'You capture site intent and trigger follow-ups for non-bookers.' },
          gapIfNotChosen: {
            title: 'Website Intent Capture Gap',
            desc: 'If traffic lands and leaves with no capture you are paying for attention without building a follow-up asset.',
            trend: 'First-party data + intent signals are becoming the core advantage for personalization and timing.'
          }
        }
      ]
    },
    {
      id: 'q4',
      category: 'Lead Follow-Up System',
      question: '4. How do you keep interested leads from slipping through the cracks?',
      options: [
        { 
          value: 'ad-hoc', 
          points: 0,
          title: 'Adhoc', 
          desc: 'Manual reminders and memory-based follow-up'
        },
        { 
          value: 'mapped', 
          points: 0.5,
          title: 'Documented but not automated', 
          desc: 'We know the steps but execution is inconsistent'
        },
        { 
          value: 'system', 
          points: 1,
          title: 'Automated follow-up triggers', 
          desc: 'Behavior triggers sequences (e.g. pricing view â†’ follow-up; demo no-show â†’ reschedule sequence)',
          strength: { title: 'Follow-Up Triggers', desc: 'You use triggers so interested leads get a timely next step.' },
          gapIfNotChosen: {
            title: 'Lead Follow-Up Gap',
            desc: 'Manual follow-up leads to inconsistent execution missed timing and lost opportunities.',
            trend: 'Behavior-triggered follow-up systems reduce leakage and improve conversion rates.'
          }
        },
        { 
          value: 'crm', 
          points: 1,
          title: 'We have behavior-based segmentation and track of all of our communications with our clients, customers, and prospects alongside regular touchpoints', 
          desc: '',
          strength: { title: 'Follow-Up Triggers', desc: 'You use triggers so interested leads get a timely next step.' },
          gapIfNotChosen: {
            title: 'Lead Follow-Up Gap',
            desc: 'Manual follow-up leads to inconsistent execution missed timing and lost opportunities.',
            trend: 'Behavior-triggered follow-up systems reduce leakage and improve conversion rates.'
          }
        }
      ]
    },
    {
      id: 'q5',
      category: 'Retention & LTV',
      question: '5. Is your revenue mostly from new or existing clients / customers?',
      options: [
        { 
          value: 'unsure', 
          points: 0,
          title: 'Not sure', 
          desc: 'Do not have a system or not actively tracking'
        },
        { 
          value: 'acq-heavy', 
          points: 0.25,
          title: '80%+ new 20% or less existing', 
          desc: 'New customers are the main source of revenue'
        },
        { 
          value: 'balanced', 
          points: 0.25,
          title: '50/50 split', 
          desc: 'Both generate an equal amount of revenue'
        },
        { 
          value: 'ltv-first', 
          points: 1,
          title: '60%+ existing 40% new', 
          desc: 'Customer lifetime value (LTV) and expansion are the growth engine',
          strength: { title: 'LTV-First Strategy', desc: 'You treat retention and expansion as core growth.' },
          gapIfNotChosen: {
            title: 'LTV & Retention Gap',
            desc: 'Teams that over-prioritize acquisition often miss compounding growth from retention and expansion.',
            trend: 'Retention and expansion are increasingly treated as primary growth levers.'
          }
        }
      ]
    },
    {
      id: 'q6',
      category: 'Owned Distribution',
      question: '6. Do you have an owned distribution channel (newsletter community audience)?',
      options: [
        { 
          value: 'none', 
          points: 0,
          title: 'No', 
          desc: 'Rely on paid reach + outbound'
        },
        { 
          value: 'basic', 
          points: 0.5,
          title: 'Starting one', 
          desc: 'Early newsletter early audience building'
        },
        { 
          value: 'strong', 
          points: 1,
          title: 'Strong owned channel', 
          desc: 'Consistent audience that drives pipeline',
          strength: { title: 'Owned Distribution', desc: 'You control a compounding asset that reliably reaches your market.' },
          gapIfNotChosen: {
            title: 'Owned Distribution Gap',
            desc: 'Without an owned channel you depend on paid reach and outbound effort for attention.',
            trend: 'Owned audiences reduce CAC and create compounding distribution.'
          }
        }
      ]
    },
    {
      id: 'q7',
      category: 'Distribution Strategy',
      question: '7. How do you distribute content and reach prospects?',
      options: [
        { 
          value: 'isolated', 
          points: 0,
          title: 'Isolated tactics', 
          desc: 'Email OR ads OR LinkedIn; focused on individual channel strategies'
        },
        { 
          value: 'coordinated', 
          points: 0.5,
          title: 'Coordinated across 2â€“3 channels', 
          desc: 'Some synergy but not fully integrated'
        },
        { 
          value: 'ecosystem', 
          points: 1,
          title: 'Ecosystem strategy (owned + earned + paid)', 
          desc: 'Channels feed each other (content â†’ email â†’ retargeting â†’ conversion)',
          strength: { title: 'Ecosystem Distribution', desc: 'Owned + earned + paid channels are aligned.' },
          gapIfNotChosen: {
            title: 'Distribution & Ecosystem Gap',
            desc: 'Isolated channels underperform integrated ecosystems where channels feed each other.',
            trend: 'Community and owned distribution increasingly compete with paid reach.'
          }
        }
      ]
    },
    {
      id: 'q8',
      category: 'Trust & Positioning',
      question: '8. How do you build credibility with cold/warm prospects?',
      options: [
        { 
          value: 'pitch', 
          points: 0,
          title: 'Product-first', 
          desc: 'Lead with services, features, benefits, and / or pricing'
        },
        { 
          value: 'proof', 
          points: 0.5,
          title: 'Proof-driven', 
          desc: 'Utilize case studies, results, testimonials to demonstrate expertise and build credibility'
        },
        { 
          value: 'trust', 
          points: 0.5,
          title: 'Trust-first, brand-focused', 
          desc: 'Lead with insights and brand awareness, building trust through credibility and growing brand presence'
        },
        { 
          value: 'customer-first', 
          points: 1,
          title: 'Customer-focused, consistent visible thought leadership, case studies, and education', 
          desc: 'Established founder and / or executive presence, regularly share education, case studies, and resources based on insights and feedback loops',
          strength: { title: 'Customer-First, Trust-Focused Positioning', desc: 'You\'re customer focused and insight-driven, regularly building and maintaining relationships with new & existing clients / customers to consistently provide valuable education, resources, and thought leadership.' },
          gapIfNotChosen: {
            title: 'Positioning Gap',
            desc: 'Leading with product details can underperform leading with education, insights, and thought leadership based on the current landscape and regular feedback loops.',
            trend: 'Trust is increasingly built through building relationships with new and existing clients / customers or prospects, visible founder or executive presence, providing value and education, proof of expertise, and credible distribution with an obvious focus and clear understanding of the customer.'
          }
        }
      ]
    }
  ],

  // Action Plan Rules
  actionPlanRules: [
    {
      triggerGaps: ["Email Metrics", "Personalization"],
      actions: [{
        title: "Shift email KPIs to clicks conversions and revenue-per-send",
        desc: "Keep opens as directional only. Optimize segmentation and offers around outcomes.",
        priority: "high"
      }]
    },
    {
      triggerGaps: ["Email Metrics", "Personalization"],
      actions: [{
        title: "Add behavioral segmentation + automated email sequences",
        desc: "Build flows for active at-risk and dormant segments; trigger sequences from clicks visits and key events.",
        priority: "medium"
      }]
    },
    {
      triggerGaps: ["Website Intent"],
      actions: [{
        title: "Capture website intent and follow up with non-bookers",
        desc: "Track key events (pricing demo case studies). Trigger email (and optional retargeting) for visitors who did not book.",
        priority: "high"
      }]
    },
    {
      triggerGaps: ["Lead Follow-Up"],
      actions: [{
        title: "Build a simple follow-up trigger system",
        desc: "Create rules for no-shows abandoned booking pages pricing views and clicked but didn't book outcomes.",
        priority: "medium"
      }]
    },
    {
      triggerGaps: ["LTV"],
      actions: [{
        title: "Rebalance toward retention and expansion",
        desc: "Formalize onboarding adoption nudges renewal sequences and expansion offers.",
        priority: "low"
      }]
    },
    {
      triggerGaps: ["Distribution", "Owned Distribution", "Ecosystem"],
      actions: [{
        title: "Start or strengthen an owned channel",
        desc: "Newsletter or community that compounds attention and reduces paid dependency.",
        priority: "low"
      }]
    }
  ],

  // Score Tiers
  scoreTiers: [
    { minScore: 75, title: "Your strategy is strong", subtitle: "You're ahead of most. Focus on compounding your advantages.", color: "strong" },
    { minScore: 50, title: "Moderate Alignment", subtitle: "You have a solid foundation. Closing a few gaps could unlock growth.", color: "medium" },
    { minScore: 0, title: "You're missing out", subtitle: "There is untapped leverage and strategic shifts that could materially improve your results.", color: "weak" }
  ]
};

// ============================================
// ðŸš« DON'T EDIT BELOW - AUTO-GENERATED CODE
// ============================================

const urlParams = new URLSearchParams(window.location.search);
const isPreviewMode = urlParams.get('preview') === 'true';
if (isPreviewMode) {
  document.getElementById('previewButtons').classList.remove('hidden');
}

document.getElementById('mainHeadline').textContent = CONTENT.headline;
document.getElementById('mainSubheadline').textContent = CONTENT.subheadline;
document.getElementById('emailGateTitle').textContent = CONTENT.emailGateTitle;
document.getElementById('emailGateSubtitle').textContent = CONTENT.emailGateSubtitle;
// Results page headline & subheadline (match quiz)
const resultsHeadlineEl = document.getElementById('resultsHeadline');
const resultsSubheadlineEl = document.getElementById('resultsSubheadline');
if (resultsHeadlineEl) resultsHeadlineEl.textContent = CONTENT.headline;
if (resultsSubheadlineEl) resultsSubheadlineEl.textContent = CONTENT.subheadline;

const formEl = document.getElementById('auditForm');
CONTENT.questions.forEach(q => {
  const section = document.createElement('div');
  section.className = 'section';
  section.innerHTML = `
    <h2>${q.category}</h2>
    <p class="question-label">${q.question}</p>
    <div class="options">
      ${q.options.map((opt, i) => `
        <div class="option">
          <input type="radio" name="${q.id}" id="${q.id}${String.fromCharCode(97+i)}" value="${opt.value}" />
          <label for="${q.id}${String.fromCharCode(97+i)}">
            <p class="label-title">${opt.title}</p>
            <p class="label-desc">${opt.desc}</p>
          </label>
        </div>
      `).join('')}
    </div>
  `;
  formEl.appendChild(section);
});

let currentResult = null;
let currentAnswers = null;

function syncSelectedStates() {
  document.querySelectorAll('.option').forEach((opt) => {
    const radio = opt.querySelector('input[type="radio"]');
    if (!radio) return;
    opt.classList.toggle('is-selected', radio.checked);
  });
}

formEl.addEventListener('click', (e) => {
  const opt = e.target.closest('.option');
  if (!opt || !formEl.contains(opt)) return;
  const radio = opt.querySelector('input[type="radio"]');
  if (radio && !radio.checked) {
    radio.checked = true;
    radio.dispatchEvent(new Event('change', { bubbles: true }));
  }
});

formEl.addEventListener('change', () => {
  syncSelectedStates();
  updateProgress();
});

window.addEventListener('DOMContentLoaded', () => {
  syncSelectedStates();
});

function updateProgress() {
  const answers = new FormData(formEl);
  const total = CONTENT.questions.length;
  let count = 0;
  CONTENT.questions.forEach(q => {
    if (answers.get(q.id)) count++;
  });
  const percent = (count / total) * 100;
  document.getElementById('progressFill').style.width = `${percent}%`;
}

formEl.addEventListener('submit', function(e) {
  e.preventDefault();
  calculateScore();
});

function calculateScore() {
  const answers = {};
  const formData = new FormData(formEl);
  for (let [key, value] of formData.entries()) {
    answers[key] = value;
  }
  if (Object.keys(answers).length < CONTENT.questions.length) {
    alert(`Please answer all ${CONTENT.questions.length} questions`);
    return;
  }
  const result = scoreAnswers(answers);
  currentResult = result;
  currentAnswers = answers;
  showEmailGate(result.score);
}

function showEmailGate(score) {
  document.getElementById('previewScore').textContent = `${score}%`;
  document.getElementById('emailGate').classList.remove('hidden');
  document.getElementById('progressFill').style.width = '100%';
}

document.getElementById('emailForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const email = document.getElementById('userEmail').value;
  const submitBtn = document.getElementById('submitEmail');
  submitBtn.disabled = true;
  submitBtn.textContent = 'Sending...';
  try {
    await sendToConvertKit(email, currentAnswers, currentResult);
    document.getElementById('emailGate').classList.add('hidden');
    displayResults(currentResult, currentAnswers);
  } catch (error) {
    console.error('Error:', error);
    alert('There was an error. Please try again.');
    submitBtn.disabled = false;
    submitBtn.textContent = 'Get My Results';
  }
});

async function sendToConvertKit(email, answers, result) {
  const url = `https://api.convertkit.com/v3/forms/${CONTENT.convertKitFormId}/subscribe`;
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        api_key: CONTENT.convertKitApiKey,
        email: email,
        fields: {
          score: result.score,
          gaps: result.gaps.map(g => g.title).join(', '),
          strengths: result.strengths.map(s => s.title).join(', ')
        }
      })
    });
    if (!response.ok) {
      console.warn('ConvertKit API returned non-OK:', response.status, response.statusText);
      return { status: 'simulated', success: true };
    }
    return response.json();
  } catch (err) {
    console.warn('ConvertKit fetch failed, falling back to simulated success.', err);
    return { status: 'simulated', success: true };
  }
}

function scoreAnswers(answers) {
  let score = 0;
  const gaps = [];
  const strengths = [];

  CONTENT.questions.forEach(q => {
    const selectedValue = answers[q.id];
    const selectedOption = q.options.find(opt => opt.value === selectedValue);
    
    if (selectedOption) {
      score += selectedOption.points;
      
      if (selectedOption.strength) {
        strengths.push(selectedOption.strength);
      }
      
      const bestOption = q.options.reduce((best, opt) => 
        opt.points > best.points ? opt : best
      );
      
      if (selectedOption.value !== bestOption.value && bestOption.gapIfNotChosen) {
        gaps.push(bestOption.gapIfNotChosen);
      }
    }
  });

  const maxScore = CONTENT.questions.length;
  const percentScore = Math.round((score / maxScore) * 100);
  
  return { score: percentScore, gaps, strengths };
}

function escapeHtml(value) {
  return String(value ?? '')
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#039;');
}

function displayResults(result, answers) {
  document.getElementById('resultsSection').classList.remove('hidden');
  document.getElementById('auditSection').classList.add('hidden');

  updateScoreDisplay(result.score, 'scoreNumber');

  const tier = result.tier || ((CONTENT.scoreTiers || []).slice().sort((a,b)=>b.minScore-a.minScore).find(t => result.score >= t.minScore) || CONTENT.scoreTiers[CONTENT.scoreTiers.length-1]);
  if (tier) {
    const titleEl = document.getElementById('resultTitle');
    const subtitleEl = document.getElementById('resultSubtitle');
    if (titleEl) titleEl.textContent = tier.title || '';
    if (subtitleEl) subtitleEl.textContent = tier.subtitle || '';
  }

  const contentEl = document.getElementById('resultsContent');
  contentEl.innerHTML = '';

  if (result.gaps && result.gaps.length) {
    const gapsWrap = document.createElement('div');
    gapsWrap.className = 'unified-gap-card';
    gapsWrap.innerHTML = `<h3>Gaps detected</h3>`;
    result.gaps.forEach(g => {
      const div = document.createElement('div');
      div.className = 'gap-section';
      div.innerHTML = `<strong>${escapeHtml(g.title || '')}</strong><p>${escapeHtml(g.desc || '')}</p>`;
      gapsWrap.appendChild(div);
    });
    contentEl.appendChild(gapsWrap);
  }

  const actionsWrap = document.createElement('div');
  actionsWrap.className = 'actions-section';
  actionsWrap.innerHTML = `<div class="actions-label">Recommended actions</div>`;
  const list = document.createElement('div');
  list.className = 'action-items';
  (CONTENT.actionPlanRules || []).forEach(rule => {
    if (!rule.triggerGaps || !rule.actions) return;
    const triggersMatched = (rule.triggerGaps || []).some(gapName => (result.gaps || []).some(g => (g.title || '').includes(gapName) || (g.desc || '').includes(gapName))); 
    if (!triggersMatched) {
      const fallbackMatch = (rule.triggerGaps || []).some(tg => (tier && ((tier.title||'').includes(tg) || (tier.subtitle||'').includes(tg))));
      if (!fallbackMatch) return;
    }

    rule.actions.forEach(a => {
      const ai = document.createElement('div');
      ai.className = 'action-item';
      const priorityClass = a.priority ? (a.priority === 'high' ? 'priority-high' : (a.priority === 'medium' ? 'priority-medium' : 'priority-low')) : '';
      ai.innerHTML = `
        <div class="action-content">
          <div class="priority-badge ${priorityClass}">${a.priority ? a.priority.toUpperCase() : ''}</div>
          <h4>${escapeHtml(a.title || '')}</h4>
          <p>${escapeHtml(a.desc || '')}</p>
        </div>
      `;
      list.appendChild(ai);
    });
  });

  if (list.children.length) {
    actionsWrap.appendChild(list);
    contentEl.appendChild(actionsWrap);
  } else {
    actionsWrap.innerHTML += `<div class="action-bullet">We couldn't match specific actions automatically â€” consider reviewing your full assessment for gaps and priorities.</div>`;
    contentEl.appendChild(actionsWrap);
  }

  const bookingLinkEl = document.getElementById('bookingLink');
  if (bookingLinkEl && CONTENT.bookingLinkUrl) bookingLinkEl.href = CONTENT.bookingLinkUrl;
}

function buildDemoResult(score) {
  const tiers = (CONTENT.scoreTiers || []).slice().sort((a,b)=>b.minScore-a.minScore);
  const tier = tiers.find(t => score >= t.minScore) || { color: 'weak', title: '', subtitle: '' };

  const allTriggers = (CONTENT.actionPlanRules || []).flatMap(rule => rule.triggerGaps || []);
  let pickedTriggers = [];
  if (score < 50) pickedTriggers = allTriggers.slice(0, 2);
  else if (score < 75) pickedTriggers = allTriggers.slice(0, 1);
  else pickedTriggers = [];

  const gaps = pickedTriggers.map(t => ({ title: t, desc: `Demo gap: ${t} â€” consider improving this area.` }));

  const strengths = [];
  (CONTENT.questions || []).forEach(q => {
    (q.options || []).forEach(o => {
      if (o.strength && strengths.length < 2) strengths.push(o.strength);
    });
  });

  return { score, gaps, strengths, tier };
}

function showDemoResult(score) {
  const eg = document.getElementById('emailGate'); if (eg) eg.classList.add('hidden');
  const pf = document.getElementById('progressFill'); if (pf) pf.style.width = '100%';

  const demo = buildDemoResult(score);

  if (typeof displayResults === 'function') {
    displayResults(demo, {});
    updateScoreDisplay(demo.score, 'scoreNumber');
  } else {
    updatePreviewScoreDisplay(score);
    document.getElementById('emailGate').classList.remove('hidden');
  }
}

window.previewLow  = function() { showDemoResult(32); };
window.previewMid  = function() { showDemoResult(62); };
window.previewHigh = function() { showDemoResult(88); };

function updateScoreDisplay(score, targetElId = 'scoreNumber') {
  const el = document.getElementById(targetElId);
  if (!el) return;
  const tiers = (CONTENT.scoreTiers || []).slice().sort((a,b)=>b.minScore-a.minScore);
  const tier = tiers.find(t => score >= t.minScore) || tiers[tiers.length - 1] || { color: 'weak' };
  el.textContent = `${score}%`;
  el.classList.remove('strong','medium','weak');
  const colorClass = tier.color || (score >= 75 ? 'strong' : (score >= 50 ? 'medium' : 'weak'));
  el.classList.add(colorClass);
}

function updatePreviewScoreDisplay(score) {
  const el = document.getElementById('previewScore');
  if (!el) return;
  el.textContent = `${score}%`;
  el.classList.remove('strong','medium','weak');
  const tiers = (CONTENT.scoreTiers || []).slice().sort((a,b)=>b.minScore-a.minScore);
  const tier = tiers.find(t => score >= t.minScore) || { color: 'weak' };
  el.classList.add(tier.color || (score >= 75 ? 'strong' : (score >= 50 ? 'medium' : 'weak')));
}

function backToQuiz() {
  document.getElementById('resultsSection').classList.add('hidden');
  document.getElementById('auditSection').classList.remove('hidden');
}

function downloadPDF() {
  window.print();
}

function resetAudit() {
  formEl.reset();
  document.getElementById('auditSection').classList.remove('hidden');
  document.getElementById('resultsSection').classList.add('hidden');
  document.getElementById('emailGate').classList.add('hidden');
  document.getElementById('progressFill').style.width = '0%';
  currentResult = null;
  currentAnswers = null;
  window.scrollTo(0, 0);
}
  </script>
</body>
</html>
